function r(i,e,t,s,o,a,n,v){var l=typeof i=="function"?i.options:i;return e&&(l.render=e,l.staticRenderFns=t,l._compiled=!0),l._scopeId="data-v-"+a,{exports:i,options:l}}const d={mixins:[Fieldtype],data(){return{episodes:[],searchQuery:"",selectedEpisodeId:null,loading:!1,findingLinks:!1,error:null,searchTimeout:null}},mounted(){this.loadEpisodes(),this.value&&this.value.episode_id&&(this.selectedEpisodeId=this.value.episode_id)},methods:{async loadEpisodes(i=""){this.loading=!0,this.error=null;try{const e=await this.$axios.get("/cp/podcast-link-finder/search-episodes",{params:{query:i}});this.episodes=e.data.episodes||[]}catch(e){this.error="Failed to load episodes. Please check your API credentials.",console.error(e)}finally{this.loading=!1}},debouncedSearch(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.loadEpisodes(this.searchQuery)},500)},async onEpisodeSelected(){if(!this.selectedEpisodeId){this.update({episode_id:null,episode_title:null,spotify_link:null,apple_podcasts_link:null,youtube_link:null});return}const i=this.episodes.find(e=>e.id===this.selectedEpisodeId);this.update({episode_id:i.id,episode_title:i.title,spotify_link:this.value.spotify_link,apple_podcasts_link:this.value.apple_podcasts_link,youtube_link:this.value.youtube_link}),this.config.auto_find!==!1&&await this.findLinks()},async findLinks(){this.findingLinks=!0,this.error=null;try{const i=await this.$axios.post("/cp/podcast-link-finder/find-links",{episode_id:this.selectedEpisodeId});if(i.data.success){const e=i.data.links;this.update({...this.value,spotify_link:e.spotify||this.value.spotify_link,apple_podcasts_link:e.apple_podcasts||this.value.apple_podcasts_link,youtube_link:e.youtube||this.value.youtube_link})}}catch(i){this.error="Failed to find links. You can enter them manually.",console.error(i)}finally{this.findingLinks=!1}},formatDate(i){return i?new Date(i).toLocaleDateString():""}}};var p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"podcast-link-finder"},[t("div",{staticClass:"mb-4"},[t("label",{staticClass:"block mb-2 font-bold"},[e._v("Select Episode from Transistor")]),t("div",{staticClass:"mb-2"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"input-text",attrs:{type:"text",placeholder:"Search episodes..."},domProps:{value:e.searchQuery},on:{input:[function(s){s.target.composing||(e.searchQuery=s.target.value)},e.debouncedSearch]}})]),e.loading?t("div",{staticClass:"text-gray-500 py-2"},[e._v(" Loading episodes... ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedEpisodeId,expression:"selectedEpisodeId"}],staticClass:"input-text",on:{change:[function(s){var o=Array.prototype.filter.call(s.target.options,function(a){return a.selected}).map(function(a){var n="_value"in a?a._value:a.value;return n});e.selectedEpisodeId=s.target.multiple?o:o[0]},e.onEpisodeSelected]}},[t("option",{domProps:{value:null}},[e._v("-- Select an episode --")]),e._l(e.episodes,function(s){return t("option",{key:s.id,domProps:{value:s.id}},[e._v(" "+e._s(s.title)+" ("+e._s(e.formatDate(s.published_at))+") ")])})],2)]),e.value.episode_title?t("div",{staticClass:"bg-blue-50 border border-blue-200 rounded p-4 mb-4"},[t("div",{staticClass:"font-bold mb-1"},[e._v("Selected Episode:")]),t("div",[e._v(e._s(e.value.episode_title))])]):e._e(),e.findingLinks?t("div",{staticClass:"bg-yellow-50 border border-yellow-200 rounded p-4 mb-4"},[t("div",{staticClass:"flex items-center"},[t("svg",{staticClass:"animate-spin h-5 w-5 mr-2 text-yellow-600",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"}},[t("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),t("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}})]),t("span",[e._v("Finding links across platforms...")])])]):e._e(),t("div",{staticClass:"space-y-3"},[t("div",[t("label",{staticClass:"block mb-1 font-bold"},[e._v("Spotify Link")]),t("div",{staticClass:"flex items-center space-x-2"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.value.spotify_link,expression:"value.spotify_link"}],staticClass:"input-text flex-1",attrs:{type:"url",readonly:!e.config.allow_manual_override,placeholder:"https://open.spotify.com/episode/..."},domProps:{value:e.value.spotify_link},on:{input:function(s){s.target.composing||e.$set(e.value,"spotify_link",s.target.value)}}}),e.value.spotify_link?t("span",{staticClass:"text-green-600"},[e._v("✓")]):t("span",{staticClass:"text-gray-400"},[e._v("—")])])]),t("div",[t("label",{staticClass:"block mb-1 font-bold"},[e._v("Apple Podcasts Link")]),t("div",{staticClass:"flex items-center space-x-2"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.value.apple_podcasts_link,expression:"value.apple_podcasts_link"}],staticClass:"input-text flex-1",attrs:{type:"url",readonly:!e.config.allow_manual_override,placeholder:"https://podcasts.apple.com/..."},domProps:{value:e.value.apple_podcasts_link},on:{input:function(s){s.target.composing||e.$set(e.value,"apple_podcasts_link",s.target.value)}}}),e.value.apple_podcasts_link?t("span",{staticClass:"text-green-600"},[e._v("✓")]):t("span",{staticClass:"text-gray-400"},[e._v("—")])])]),t("div",[t("label",{staticClass:"block mb-1 font-bold"},[e._v("YouTube Link")]),t("div",{staticClass:"flex items-center space-x-2"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.value.youtube_link,expression:"value.youtube_link"}],staticClass:"input-text flex-1",attrs:{type:"url",readonly:!e.config.allow_manual_override,placeholder:"https://www.youtube.com/watch?v=..."},domProps:{value:e.value.youtube_link},on:{input:function(s){s.target.composing||e.$set(e.value,"youtube_link",s.target.value)}}}),e.value.youtube_link?t("span",{staticClass:"text-green-600"},[e._v("✓")]):t("span",{staticClass:"text-gray-400"},[e._v("—")])])])]),e.error?t("div",{staticClass:"mt-4 bg-red-50 border border-red-200 rounded p-4 text-red-700"},[e._v(" "+e._s(e.error)+" ")]):e._e()])},c=[],u=r(d,p,c,!1,null,"5383e189");const _=u.exports;Statamic.$components.register("podcast_link_finder-fieldtype",_);
