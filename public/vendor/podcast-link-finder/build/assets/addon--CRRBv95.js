function r(a,e,t,s,i,l,o,f){var n=typeof a=="function"?a.options:a;return e&&(n.render=e,n.staticRenderFns=t,n._compiled=!0),n._scopeId="data-v-"+l,{exports:a,options:n}}const u={mixins:[Fieldtype],data(){return{episodes:[],searchQuery:"",selectedEpisodeId:null,loading:!1,searchingPlatforms:!1,error:null,searchTimeout:null,platformResults:null,selectedYouTube:null,selectedSpotify:null,selectedApple:null,manualYouTube:"",manualSpotify:"",manualApple:""}},mounted(){this.loadEpisodes(),this.value&&this.value.episode_id&&(this.selectedEpisodeId=this.value.episode_id,this.selectedYouTube=this.value.youtube_link||null,this.selectedSpotify=this.value.spotify_link||null,this.selectedApple=this.value.apple_podcasts_link||null,this.manualYouTube=this.value.youtube_link||"",this.manualSpotify=this.value.spotify_link||"",this.manualApple=this.value.apple_podcasts_link||"")},methods:{async loadEpisodes(a=""){this.loading=!0,this.error=null;try{const e=await this.$axios.get("/cp/podcast-link-finder/search-episodes",{params:{query:a}});this.episodes=e.data.episodes||[]}catch(e){this.error="Failed to load episodes. Please check your API credentials.",console.error(e)}finally{this.loading=!1}},debouncedSearch(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.loadEpisodes(this.searchQuery)},500)},async onEpisodeSelected(){if(!this.selectedEpisodeId){this.update({episode_id:null,episode_title:null,spotify_link:null,apple_podcasts_link:null,youtube_link:null}),this.platformResults=null,this.selectedYouTube=null,this.selectedSpotify=null,this.selectedApple=null,this.manualYouTube="",this.manualSpotify="",this.manualApple="";return}const a=this.episodes.find(e=>e.id===this.selectedEpisodeId);this.update({episode_id:a.id,episode_title:a.title,spotify_link:null,apple_podcasts_link:null,youtube_link:null}),this.platformResults=null,this.selectedYouTube=null,this.selectedSpotify=null,this.selectedApple=null,this.manualYouTube="",this.manualSpotify="",this.manualApple="",this.config.auto_find!==!1&&await this.searchAllPlatforms()},async searchAllPlatforms(){this.searchingPlatforms=!0,this.error=null;try{const a=await this.$axios.post("/cp/podcast-link-finder/search-platforms",{episode_id:this.selectedEpisodeId});a.data.success&&(this.platformResults=a.data.results,this.config.auto_find!==!1&&(this.platformResults.youtube.length>0&&(this.selectedYouTube=this.platformResults.youtube[0].url,this.onYouTubeSelected()),this.platformResults.spotify.length>0&&(this.selectedSpotify=this.platformResults.spotify[0].url,this.onSpotifySelected()),this.platformResults.apple_podcasts.length>0&&(this.selectedApple=this.platformResults.apple_podcasts[0].url,this.onAppleSelected())))}catch(a){this.error="Failed to search platforms. You can enter links manually.",console.error(a)}finally{this.searchingPlatforms=!1}},onYouTubeSelected(){this.manualYouTube=this.selectedYouTube||"",this.updateLinks()},onSpotifySelected(){this.manualSpotify=this.selectedSpotify||"",this.updateLinks()},onAppleSelected(){this.manualApple=this.selectedApple||"",this.updateLinks()},onManualYouTubeInput(){this.selectedYouTube=this.manualYouTube,this.updateLinks()},onManualSpotifyInput(){this.selectedSpotify=this.manualSpotify,this.updateLinks()},onManualAppleInput(){this.selectedApple=this.manualApple,this.updateLinks()},updateLinks(){this.update({...this.value,spotify_link:this.selectedSpotify||null,apple_podcasts_link:this.selectedApple||null,youtube_link:this.selectedYouTube||null})},formatDate(a){return a?new Date(a).toLocaleDateString():""}}};var p=function(){var e=this,t=e._self._c;return t("div",{staticClass:"podcast-link-finder"},[t("div",{staticClass:"mb-4"},[t("label",{staticClass:"block mb-2 font-bold"},[e._v("Select Episode from Transistor")]),t("div",{staticClass:"mb-2"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchQuery,expression:"searchQuery"}],staticClass:"input-text",attrs:{type:"text",placeholder:"Search episodes..."},domProps:{value:e.searchQuery},on:{input:[function(s){s.target.composing||(e.searchQuery=s.target.value)},e.debouncedSearch]}})]),e.loading?t("div",{staticClass:"text-gray-500 py-2"},[e._v(" Loading episodes... ")]):t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedEpisodeId,expression:"selectedEpisodeId"}],staticClass:"input-text",on:{change:[function(s){var i=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var o="_value"in l?l._value:l.value;return o});e.selectedEpisodeId=s.target.multiple?i:i[0]},e.onEpisodeSelected]}},[t("option",{domProps:{value:null}},[e._v("-- Select an episode --")]),e._l(e.episodes,function(s){return t("option",{key:s.id,domProps:{value:s.id}},[e._v(" "+e._s(s.title)+" ("+e._s(e.formatDate(s.published_at))+") ")])})],2)]),e.value.episode_title?t("div",{staticClass:"bg-blue-50 border border-blue-200 rounded p-4 mb-4"},[t("div",{staticClass:"font-bold mb-1"},[e._v("Selected Episode:")]),t("div",[e._v(e._s(e.value.episode_title))]),!e.searchingPlatforms&&!e.platformResults?t("button",{staticClass:"btn-primary mt-3",attrs:{type:"button"},on:{click:e.searchAllPlatforms}},[e._v(" Search All Platforms ")]):e._e()]):e._e(),e.searchingPlatforms?t("div",{staticClass:"bg-yellow-50 border border-yellow-200 rounded p-4 mb-4"},[t("div",{staticClass:"flex items-center"},[t("svg",{staticClass:"animate-spin h-5 w-5 mr-2 text-yellow-600",attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"}},[t("circle",{staticClass:"opacity-25",attrs:{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}}),t("path",{staticClass:"opacity-75",attrs:{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"}})]),t("span",[e._v("Searching across all platforms...")])])]):e._e(),e.platformResults?t("div",{staticClass:"space-y-4 mb-4"},[t("div",{staticClass:"bg-white border border-gray-300 rounded p-4"},[t("label",{staticClass:"block mb-2 font-bold text-red-600"},[t("span",{staticClass:"inline-block mr-2"},[e._v("â–¶")]),e._v(" YouTube "),e.platformResults.youtube.length>0?t("span",{staticClass:"text-sm text-gray-500 font-normal ml-2"},[e._v(" ("+e._s(e.platformResults.youtube.length)+" results) ")]):e._e()]),e.platformResults.youtube.length>0?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedYouTube,expression:"selectedYouTube"}],staticClass:"input-text mb-2",on:{change:[function(s){var i=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var o="_value"in l?l._value:l.value;return o});e.selectedYouTube=s.target.multiple?i:i[0]},e.onYouTubeSelected]}},[t("option",{domProps:{value:null}},[e._v("-- Select a video --")]),e._l(e.platformResults.youtube,function(s,i){return t("option",{key:i,domProps:{value:s.url}},[e._v(" "+e._s(s.title)+" ("+e._s(s.score)+"% match) ")])})],2),e.selectedYouTube?t("div",{staticClass:"text-sm text-gray-600 mt-1"},[t("a",{staticClass:"text-blue-600 hover:underline",attrs:{href:e.selectedYouTube,target:"_blank"}},[e._v(" "+e._s(e.selectedYouTube)+" ")])]):e._e()]):t("div",{staticClass:"text-gray-500 text-sm"},[e._v(" No matches found ")])]),t("div",{staticClass:"bg-white border border-gray-300 rounded p-4"},[t("label",{staticClass:"block mb-2 font-bold text-green-600"},[t("span",{staticClass:"inline-block mr-2"},[e._v("â™«")]),e._v(" Spotify "),e.platformResults.spotify.length>0?t("span",{staticClass:"text-sm text-gray-500 font-normal ml-2"},[e._v(" ("+e._s(e.platformResults.spotify.length)+" results) ")]):e._e()]),e.platformResults.spotify.length>0?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedSpotify,expression:"selectedSpotify"}],staticClass:"input-text mb-2",on:{change:[function(s){var i=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var o="_value"in l?l._value:l.value;return o});e.selectedSpotify=s.target.multiple?i:i[0]},e.onSpotifySelected]}},[t("option",{domProps:{value:null}},[e._v("-- Select an episode --")]),e._l(e.platformResults.spotify,function(s,i){return t("option",{key:i,domProps:{value:s.url}},[e._v(" "+e._s(s.title)+" ("+e._s(s.score)+"% match) ")])})],2),e.selectedSpotify?t("div",{staticClass:"text-sm text-gray-600 mt-1"},[t("a",{staticClass:"text-blue-600 hover:underline",attrs:{href:e.selectedSpotify,target:"_blank"}},[e._v(" "+e._s(e.selectedSpotify)+" ")])]):e._e()]):t("div",{staticClass:"text-gray-500 text-sm"},[e._v(" No matches found ")])]),t("div",{staticClass:"bg-white border border-gray-300 rounded p-4"},[t("label",{staticClass:"block mb-2 font-bold text-purple-600"},[t("span",{staticClass:"inline-block mr-2"},[e._v("ðŸŽ™")]),e._v(" Apple Podcasts "),e.platformResults.apple_podcasts.length>0?t("span",{staticClass:"text-sm text-gray-500 font-normal ml-2"},[e._v(" ("+e._s(e.platformResults.apple_podcasts.length)+" results) ")]):e._e()]),e.platformResults.apple_podcasts.length>0?t("div",[t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedApple,expression:"selectedApple"}],staticClass:"input-text mb-2",on:{change:[function(s){var i=Array.prototype.filter.call(s.target.options,function(l){return l.selected}).map(function(l){var o="_value"in l?l._value:l.value;return o});e.selectedApple=s.target.multiple?i:i[0]},e.onAppleSelected]}},[t("option",{domProps:{value:null}},[e._v("-- Select an episode --")]),e._l(e.platformResults.apple_podcasts,function(s,i){return t("option",{key:i,domProps:{value:s.url}},[e._v(" "+e._s(s.title)+" ("+e._s(s.score)+"% match) ")])})],2),e.selectedApple?t("div",{staticClass:"text-sm text-gray-600 mt-1"},[t("a",{staticClass:"text-blue-600 hover:underline",attrs:{href:e.selectedApple,target:"_blank"}},[e._v(" "+e._s(e.selectedApple)+" ")])]):e._e()]):t("div",{staticClass:"text-gray-500 text-sm"},[e._v(" No matches found ")])])]):e._e(),e.config.allow_manual_override&&e.value.episode_id?t("div",{staticClass:"mt-6 pt-4 border-t border-gray-300"},[t("div",{staticClass:"mb-3 text-sm text-gray-600"},[e._v(" Or enter links manually: ")]),t("div",{staticClass:"space-y-3"},[t("div",[t("label",{staticClass:"block mb-1 font-bold text-sm"},[e._v("Spotify Link")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.manualSpotify,expression:"manualSpotify"}],staticClass:"input-text",attrs:{type:"url",placeholder:"https://open.spotify.com/episode/..."},domProps:{value:e.manualSpotify},on:{input:[function(s){s.target.composing||(e.manualSpotify=s.target.value)},e.onManualSpotifyInput]}})]),t("div",[t("label",{staticClass:"block mb-1 font-bold text-sm"},[e._v("Apple Podcasts Link")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.manualApple,expression:"manualApple"}],staticClass:"input-text",attrs:{type:"url",placeholder:"https://podcasts.apple.com/..."},domProps:{value:e.manualApple},on:{input:[function(s){s.target.composing||(e.manualApple=s.target.value)},e.onManualAppleInput]}})]),t("div",[t("label",{staticClass:"block mb-1 font-bold text-sm"},[e._v("YouTube Link")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.manualYouTube,expression:"manualYouTube"}],staticClass:"input-text",attrs:{type:"url",placeholder:"https://www.youtube.com/watch?v=..."},domProps:{value:e.manualYouTube},on:{input:[function(s){s.target.composing||(e.manualYouTube=s.target.value)},e.onManualYouTubeInput]}})])])]):e._e(),e.error?t("div",{staticClass:"mt-4 bg-red-50 border border-red-200 rounded p-4 text-red-700"},[e._v(" "+e._s(e.error)+" ")]):e._e()])},d=[],c=r(u,p,d,!1,null,"dbf889a7");const m=c.exports;Statamic.$components.register("podcast_link_finder-fieldtype",m);
